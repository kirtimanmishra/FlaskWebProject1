<script>
    function fetchPendingJobs() {
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                document.getElementById("id_pending").innerHTML = this.responseText;
            }
        };
        nodeid = document.getElementById("id_login").value;
        xhttp.open("GET", "http://localhost:5000/getjobs?nodeid="+nodeid, true);
        xhttp.send();
    } 

    function renderJob() {
        selected_job = "None";
        choices = document.getElementsByName("job_name");
        for (var i = 0; i < choices.length; i++) {
            if (choices[i].checked) {
                selected_job = choices[i].value;
            }
        }
        //alert(selected_job);
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function() {

            if (this.readyState == 4 && this.status == 200) {
                document.getElementById("id_nodegui").value = this.responseText;
            }
        };

        xhttp.open("GET", "http://localhost:5000/renderjob?jobid=" + selected_job, true);
        xhttp.send();
    } //renderJob

    function submitNode() {
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                document.getElementById("id_nodegui").value = this.responseText;
            }
        };
        xhttp.open("GET", "http://localhost:5000/wfe/wf/strsubmit?datastr=" + document.getElementById("id_nodegui").value, true);
        xhttp.send();
        fetchPendingJobs()
    }
</script>

<table style="width:100%" border="1">
    <tr>
        <td> Login: <textarea id="id_login"> </textarea> <button id="id_btn_login" onclick="fetchPendingJobs()"> Submit </button> </td>
    </tr>
    <tr>
        <td>
            <table border="1" style="width:100%">
                <tr style="width:100%">
                    <td style="width:30%"> Pending jobs: <button id="id_btn_jobs_refresh" onclick="fetchPendingJobs()"> Refresh </button> <div id="id_pending"> </div></td>
                    <td style="width:100%;height:50%"> Node GUI: <textarea id="id_nodegui" style="width:100%" rows="30"> </textarea> <br/> 
                        <button onclick="submitNode()"> Execute node </button> 
                    </td>
                </tr>
            </table>
        </td>
    </tr>
</table>



